load("//shared/bazel/rules:cc_rules.bzl", "wpilib_cc_library", "wpilib_cc_static_library")
load("//shared/bazel/rules/publishing:publishing.bzl", "bundle_library_artifacts")

wpilib_cc_library(
    name = "googletest",
    srcs = glob(["src/**"]),
    hdrs = glob(["include/**"]),
    hdrs_pkg_root = "include",
    include_third_party_notices = True,
    includes = ["src/googletest"],
    srcs_pkg_root = "src",
    strip_include_prefix = "include",
    visibility = ["//visibility:public"],
)

wpilib_cc_static_library(
    name = "static/googletest",
    static_lib_name = select({
        "@bazel_tools//src/conditions:windows": "static/googletest.lib",
        "//conditions:default": "static/libgoogletest.a",
    }),
    visibility = ["//visibility:public"],
    deps = [
        ":googletest",
    ],
)

bundle_library_artifacts(
    name = "publishing_bundle",
    cc_hdr_pkg = ":googletest-hdrs-zip",
    cc_src_pkg = ":googletest-srcs-zip",
    cc_static_library_pkg = ":static/googletest-static-zip",
    group_id = "edu.wpi.first.thirdparty.googletest",
    library_base_name = "googletest",
)
